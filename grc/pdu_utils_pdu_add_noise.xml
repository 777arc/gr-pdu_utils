<?xml version="1.0"?>
<block>
  <name>Add Noise</name>
  <key>pdu_utils_pdu_add_noise</key>
  <category>[Sandia]/PDU Utilities/Debug Utils</category>
  <import>import pdu_utils</import>
  <make>pdu_utils.pdu_add_noise($level, $offset, $scale, $seed, $dist)</make>

  <callback>set_noise_level($level)</callback>
  <callback>set_offset($offset)</callback>
  <callback>set_scale($scale)</callback>
  <callback>set_noise_dist($dist)</callback>

  <param>
    <name>Noise Level (stddev)</name>
    <key>level</key>
    <value>0.0</value>
    <type>float</type>
  </param>
  <param>
    <name>Offset</name>
    <key>offset</key>
    <value>0.0</value>
    <type>float</type>
  </param>
  <param>
    <name>Scale</name>
    <key>scale</key>
    <value>1.0</value>
    <type>float</type>
  </param>

  <param>
    <name>Seed</name>
    <key>seed</key>
    <value>123456789</value>
    <type>int</type>
  </param>
  
  <param>
    <name>Distribution</name>
    <key>dist</key>
    <value>pdu_utils.UNIFORM</value>
    <type>int</type>
    <option>
      <name>Uniform</name>
      <key>pdu_utils.UNIFORM</key>
    </option>
    <option>
      <name>Gaussian</name>
      <key>pdu_utils.GAUSSIAN</key>
    </option>
  </param>

  <check>$level &gt;= 0</check>

  <sink>
    <name>pdu_in</name>
    <type>message</type>
    <optional>1</optional>
  </sink>

  <source>
    <name>pdu_out</name>
    <type>message</type>
    <optional>1</optional>
  </source>

  <doc>
  Adds randomly generated noise to u8, f32 or c32 PDUs, can also add an
offset or scale factor. Noise is applied first, then scaling, then offset.

Noise Level is multiplied against the generated normal/uniform distribution sample. In this
way, it represents the standard deviation, or sqrt(variance).

Distribution selection is limited to uniform or gaussian.

Complex noise is generated as a random magnitude and phase.

U8 noise is binary.


</doc>

</block>
